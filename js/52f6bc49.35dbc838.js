(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["52f6bc49"],{"0d38":function(t,e,n){},"17c9":function(t,e,n){"use strict";n.d(e,"d",function(){return c}),n.d(e,"g",function(){return l}),n.d(e,"c",function(){return m}),n.d(e,"f",function(){return h}),n.d(e,"i",function(){return g}),n.d(e,"j",function(){return f}),n.d(e,"h",function(){return y}),n.d(e,"e",function(){return k}),n.d(e,"b",function(){return w}),n.d(e,"a",function(){return x});var i=n("a34a"),a=n.n(i),r=(n("7514"),n("96cf"),n("6b54"),n("7f7f"),n("c973")),o=n.n(r);function c(t){return s.apply(this,arguments)}function s(){return s=o()(a.a.mark(function t(e){var n,i;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),n=e.Bmob.Query("about"),t.next=4,n.find();case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}},t)})),s.apply(this,arguments)}function l(t){return u.apply(this,arguments)}function u(){return u=o()(a.a.mark(function t(e){var n,i;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),n=e.Bmob.Query("link"),n.order("-createdAt"),t.next=5,n.find();case 5:return i=t.sent,t.abrupt("return",i);case 7:case"end":return t.stop()}},t)})),u.apply(this,arguments)}function m(t,e,n){return!(!e||!n)||(t.$q.dialog({title:"提示",message:"输入不能为空",ok:"确定"}),!1)}function p(t){return d.apply(this,arguments)}function d(){return d=o()(a.a.mark(function t(e){var n,i;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.Bmob.Query("comment"),n.order("-createdAt"),t.next=4,n.find();case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}},t)})),d.apply(this,arguments)}function h(t){t.$q.loading.show(),t.currentComments=[],t.lookReply=[],p(t).then(function(e){t.comments=e;for(var n=(t.currentPage-1)*t.pageSize;n<t.currentPage*t.pageSize;n++)n<t.comments.length&&(t.currentComments.push(t.comments[n]),t.lookReply.push(!1));t.$q.loading.hide()})}function g(t,e){t.$q.loading.show();var n=t.Bmob.Query("comment");n.set("name",t.name),n.set("content",t.content),n.save().then(function(e){t.$q.loading.hide(),t.commitDialog=!1,t.$q.dialog({title:"提示",message:"留言成功",ok:"确定"}).onOk(function(){h(t),document.documentElement.scrollTop=0})}).catch(function(e){t.$q.loading.hide(),t.$q.dialog({title:"提示",message:e.toString(),ok:"确定"})})}function f(t,e){t.$q.loading.show();var n=t.Bmob.Query("comment"),i=new Date,a={name:t.name,content:t.content,date:i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()};n.get(e).then(function(e){e.add("comment",[a]),e.save().then(function(e){t.$q.loading.show(),t.commitDialog=!1,t.$q.dialog({title:"提示",message:"回复成功",ok:"确定"}).onOk(function(){h(t),document.documentElement.scrollTop=0})}).catch(function(e){t.$q.loading.hide(),t.$q.dialog({title:"提示",message:e.toString(),ok:"确定"})})}).catch(function(e){t.$q.loading.hide(),t.$q.dialog({title:"提示",message:e.toString(),ok:"确定"})})}function y(t){return b.apply(this,arguments)}function b(){return b=o()(a.a.mark(function t(e){var n,i;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.Bmob.Query("tag"),n.order("tagName"),t.next=4,n.find();case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}},t)})),b.apply(this,arguments)}function k(t){return q.apply(this,arguments)}function q(){return q=o()(a.a.mark(function t(e){var n,i;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),n=e.Bmob.Query("article"),n.order("-createdAt"),t.next=5,n.find();case 5:return i=t.sent,t.abrupt("return",i);case 7:case"end":return t.stop()}},t)})),q.apply(this,arguments)}function w(t,e){return v.apply(this,arguments)}function v(){return v=o()(a.a.mark(function t(e,n){var i,r;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=e.Bmob.Query("article"),i.equalTo("objectId","==",n),t.next=4,i.find();case 4:return r=t.sent,t.abrupt("return",r);case 6:case"end":return t.stop()}},t)})),v.apply(this,arguments)}function x(t,e){return C.apply(this,arguments)}function C(){return C=o()(a.a.mark(function t(e,n){var i,r;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i=e.Bmob.Query("article"),i.order("-createdAt"),""!==n&&i.containedIn("tag",[n]),t.next=5,i.find();case 5:return r=t.sent,t.abrupt("return",r);case 7:case"end":return t.stop()}},t)})),C.apply(this,arguments)}},7965:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticStyle:{padding:"0.5rem"},attrs:{"style-fn":t.minHeight}},[n("div",{ref:"tt",staticClass:"row justify-center items-start margin-bottom"},[n("q-card",{staticClass:"my-card",class:t.width,style:t.commentHeight,attrs:{bordered:""}},[n("q-toolbar",{staticClass:"bg-white text-black"},[n("div",{staticClass:"card-title"},[t._v("留言板")])]),n("q-separator"),n("q-card-section",{class:t.fontsize},t._l(t.currentComments,function(e,i){return n("q-list",{key:i},[n("q-item",{staticClass:"no-padding-bottom"},[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{rounded:""}},[n("img",{staticStyle:{height:"32px",width:"32px"},attrs:{src:"statics/app-logo-128x128.png"}})])],1),n("q-item-section",[t._v(t._s(e.name))]),n("q-item-section",{attrs:{side:""}},[n("q-item-label",[t._v(t._s(e.createdAt.split(" ")[0]))])],1)],1),n("q-item",{staticClass:"no-padding-bottom row items-center"},[n("q-item-label",[t._v(t._s(e.content))])],1),e.replyTag?n("div",{staticStyle:{padding:"0.5rem 0"}},[t._l(e.comment,function(e,i){return n("div",{key:i,staticClass:"row"},[n("div",{staticClass:"col-1"}),n("div",{staticClass:"col-11 column commentBorder"},[n("div",{staticClass:"row"},[t._v(t._s(e.name)+" : "+t._s(e.content))]),n("div",{staticClass:"row justify-end items-center"},[n("div",{staticClass:"text-grey-7",staticStyle:{"margin-right":"0.25rem"}},[t._v(t._s(e.date))])])])])}),n("div",{staticClass:"row"},[n("div",{staticClass:"col-1"}),n("q-separator",{staticStyle:{background:"#CBCBCB"}})],1)],2):t._e(),n("q-item",{staticClass:"items-end row justify-end no-padding-top no-min-height"},[e.comment&&0!==e.comment.length&&!e.replyTag?n("q-chip",{attrs:{dense:!t.pc,clickable:"",color:"bookmark","text-color":"black",label:"更多"},on:{click:function(t){e.replyTag=!e.replyTag}}}):t._e(),e.replyTag?n("q-chip",{attrs:{dense:!t.pc,clickable:"",color:"bookmark","text-color":"black",label:"收起"},on:{click:function(t){e.replyTag=!e.replyTag}}}):t._e(),n("q-chip",{attrs:{dense:!t.pc,clickable:"",color:"bookmark","text-color":"black",label:"回复"},on:{click:function(n){return t.writeReplyTag(e.name,e.objectId)}}})],1),n("q-separator")],1)}),1),t.comments.length>t.pageSize?n("q-pagination",{staticClass:"flex-center margin-bottom",attrs:{size:"1rem",max:t.maxPage,"max-pages":t.pageSize},on:{input:t.pageChange},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)],1),n("q-dialog",{model:{value:t.commitDialog,callback:function(e){t.commitDialog=e},expression:"commitDialog"}},[n("q-card",{staticClass:"my-card",style:t.dialogWidth,attrs:{bordered:""}},[n("q-card-section",{staticClass:"bg-white text-black"},[n("div",{staticClass:"text-h6"},[t._v(t._s(t.replyTitle))])]),n("q-separator"),n("q-card-section",{class:t.fontsize},[n("q-input",{attrs:{outlined:"",maxlength:"10",placeholder:"昵称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),n("q-input",{staticClass:"input-margin",staticStyle:{"padding-bottom":"0"},attrs:{outlined:"",maxlength:"200",placeholder:"请填写你的留言,200字以内",type:"textarea"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("q-card-section",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"right",staticStyle:{margin:"0 1rem 1rem 0"},attrs:{color:"primary",label:"提 交"},on:{click:t.writeComment}})],1)],1)],1),n("q-page-sticky",{attrs:{position:t.position,offset:t.offset}},[n("q-btn",{attrs:{fab:"",icon:"mdi-pencil",color:"primary"},on:{click:t.writeCommentTag}})],1)],1)},a=[],r=(n("7f7f"),n("17c9")),o={name:"PageComment",data:function(){return{pageHeight:null,pageWidth:null,commitDialog:!1,replyTitle:"写留言",replyId:null,name:null,content:null,currentPage:1,pageSize:10,comments:[],currentComments:[],lookReply:[]}},computed:{width:function(){return this.$q.platform.is.desktop?"col-6":"col-12 justify-center"},fontsize:function(){return this.$q.platform.is.desktop?"pc-font-size":"no-pc-font-size"},pc:function(){return this.$q.platform.is.desktop},commentHeight:function(){return{"min-height":this.pageHeight}},maxPage:function(){return Math.ceil(this.comments.length/this.pageSize)},dialogWidth:function(){return this.$q.platform.is.desktop?{"min-width":"600px"}:{"min-width":this.pageWidth+"px"}},position:function(){return this.$q.platform.is.desktop?"bottom-right":"bottom-left"},offset:function(){return this.$q.platform.is.desktop?[this.pageWidth/5,18]:[18,18]}},methods:{writeReplyTag:function(t,e){this.commitDialog=!0,this.replyTitle="回复 "+t,this.replyId=e},writeComment:function(){Object(r["c"])(this,this.name,this.content)&&("写留言"===this.replyTitle?Object(r["i"])(this):Object(r["j"])(this,this.replyId)),this.name=null,this.content=null},writeCommentTag:function(){this.commitDialog=!0,this.replyTitle="写留言"},more:function(t){this.lookReply[t]=!0,console.log(t)},alert:function(){this.$q.dialog({title:"提示",message:"提交成功"}).onOk(function(){console.log("确定")})},minHeight:function(t){this.pageHeight="calc(100vh - 1.5rem - ".concat(t,"px)")},pageChange:function(t){this.currentComments=[],this.lookReply=[];for(var e=(this.currentPage-1)*this.pageSize;e<this.currentPage*this.pageSize;e++)e<this.comments.length&&(this.currentComments.push(this.comments[e]),this.lookReply.push(!1));window.scrollTo(0,0)}},mounted:function(){this.pageWidth=this.$refs.tt.offsetWidth},created:function(){Object(r["f"])(this)}},c=o,s=(n("871c"),n("2877")),l=Object(s["a"])(c,i,a,!1,null,"11f4768b",null);e["default"]=l.exports},"871c":function(t,e,n){"use strict";var i=n("0d38"),a=n.n(i);a.a}}]);